#define _GNU_SOURCE

#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
//#include "./self_compiled_openssl/include/openssl/aes.h"
//#include "./self_compiled_openssl/include/openssl/aes.h"
#include <openssl/aes.h>

extern void AES_prefetch();

int main()
{
	unsigned char key[] =
	{
	  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	  // 0x51, 0x4d, 0xab, 0x12, 0xff, 0xdd, 0xb3, 0x32, 0x52, 0x8f, 0xbb, 0x1d, 0xec, 0x45, 0xce, 0xcc, 0x4f, 0x6e, 0x9c,
	  // 0x2a, 0x15, 0x5f, 0x5f, 0x0b, 0x25, 0x77, 0x6b, 0x70, 0xcd, 0xe2, 0xf7, 0x80
	};
	
	unsigned char plaintext[] =
	{
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
	};
	unsigned char ciphertext[128];

	AES_KEY key_struct;
	AES_set_encrypt_key(key, 128, &key_struct);
		
	//printf("Profiling...\n");
	
	//for(int i = 0; i < 1000; i++){
		//Measurement phase
		for (size_t j = 0; j < 16; ++j) {
		  	plaintext[j] = rand() % 256;
	  	}
		AES_encrypt(plaintext, ciphertext, &key_struct);
		//printf("Loop iteration: %d\n",i);
	//}
	
	//printf("Finished!\n");
	fflush(stdout);
	return 0;
}

